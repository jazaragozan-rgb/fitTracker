<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>fitTracker</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#1a7fb9">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="/icon-192.png">
</head>
<body>

<!-- Header -->
<header>
  <button id="menuButton">&#9776;</button>
  <div id="headerLogo">
    <img src="imagenes/logo.png" alt="Logo">
  </div>
  <button id="logoutButton"><img src="iconos/Power.png" alt="Logout"></button>
</header>

<!-- Subheader con botones -->
<div id="subHeader">
  <h2 id="tituloNivel">Dashboard</h2>
  <div id="subHeaderButtons">
    <button id="backButton" class="header-btn">←</button>
    <button id="addButton" class="header-btn">+ Añadir</button>
  </div>
</div>

<!-- Overlay y Menú lateral -->
<div id="menuOverlay" class="hidden"></div>
<nav id="sideMenu" class="sideMenu">
  <header1 id="header1">
    <h2 id="logomenulateral">
      <img src="imagenes/logo.png" alt="fitTracker">
      <span style="font-weight: lighter;">fit</span><span style="font-weight: bold;color: rgb(26, 127, 185);">Tracker</span>
    </h2>
  </header1>
  <button id="btnDashboard" class="sideMenu-btn" data-seccion="dashboard">Dashboard</button>
  <button id="btnEntrenamiento" class="sideMenu-btn" data-seccion="entrenamiento">Entrenamiento</button>
  <button id="btnSeguimiento" class="sideMenu-btn" data-seccion="seguimiento">Seguimiento</button>
  <button id="btnCalendario" class="sideMenu-btn" data-seccion="calendario">Calendario</button>
  <button id="btnNutricion" class="sideMenu-btn" data-seccion="nutricion">Nutrición</button>
</nav>

<!-- App -->
<section id="app" class="hidden"></section>

<div id="contenidoWrapper">
  <div id="contenidoSwipe">
    <main id="contenido"></main>
  </div>
</div>

<div id="timerContainer" class="hidden"></div>

<!-- Footer -->
<footer id="footerNav">
  <button id="navHome" class="footer-btn">
    <img src="iconos/Home.png" alt="Home">
  </button>
  <button id="navSettings" class="footer-btn">
    <img src="iconos/Settings.png" alt="Ajustes">
  </button>
</footer>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
<script type="module" src="script.js"></script>

<script>
  // ==================== SERVICE WORKER ====================
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js').then(reg => {
      console.log('[PWA] SW registrado en subindex');
      reg.update();

      reg.addEventListener('updatefound', () => {
        const newWorker = reg.installing;
        newWorker.addEventListener('statechange', () => {
          if (newWorker.state === 'activated') {
            window.location.reload();
          }
        });
      });
    }).catch(err => console.error('[PWA] Error SW:', err));

    navigator.serviceWorker.addEventListener('message', event => {
      if (event.data?.type === 'SW_UPDATED') {
        window.location.reload();
      }
    });
  }
</script>

</body>
</html>